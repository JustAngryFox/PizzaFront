{"ast":null,"code":"import PizzaBlockProfile from './ProfileView/PizzaBlockProfile.vue';\nimport store from './../store';\nimport axios from 'axios';\nexport default {\n  name: 'ProfileView',\n  data: () => ({\n    total: 0,\n    products_id: '',\n    store: store,\n    order: [],\n    success: false,\n    error: false,\n    name: null,\n    email: null,\n    tel: null,\n    errors: []\n  }),\n  mounted: function () {\n    this.GetOrder();\n  },\n  components: {\n    PizzaBlockProfile: PizzaBlockProfile\n  },\n  methods: {\n    GetOrder() {\n      this.order = this.store.products.pizza;\n      let i = 0;\n\n      for (i = 0; i < this.store.products.pizza.length; i++) {\n        this.total += Number(this.store.products.pizza[i].price);\n        this.products_id += this.store.products.pizza[i].id + '|';\n      }\n\n      this.store.products_id = this.products_id;\n    },\n\n    ValidateForm() {\n      this.errors = []; // eslint-disable-next-line\n\n      let reg_tel = /^(\\+7|7|8)?[\\s\\-]?\\(?[489][0-9]{2}\\)?[\\s\\-]?[0-9]{3}[\\s\\-]?[0-9]{2}[\\s\\-]?[0-9]{2}$/;\n      let reg_email = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n      if (!this.name) {\n        this.errors.push('Укажите имя.');\n      }\n\n      if (!reg_tel.test(this.tel)) {\n        this.errors.push('Некорректный номер телефона.');\n      }\n\n      if (!reg_email.test(this.email)) {\n        this.errors.push('Некорректный адрес электронной почт.');\n      }\n\n      if (this.errors.length == 0) {\n        this.SendOrder();\n      }\n    },\n\n    SendOrder() {\n      var formData = new FormData(document.forms.OrderForm);\n      axios.post('http://testpizzabackend/public/api/upload_order', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(response => {\n        console.log(\"response\", response.data.success);\n\n        if (response.data.success == 'ok') {\n          this.success = true;\n        } else {\n          this.error = true;\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAoCA;AACA;AACA;AAEA;EACAA,mBADA;EAEAC;IACAC,QADA;IAEAC,eAFA;IAGAC,YAHA;IAIAC,SAJA;IAKAC,cALA;IAMAC,YANA;IAOAP,UAPA;IAQAQ,WARA;IASAC,SATA;IAUAC;EAVA,EAFA;EAeAC;IACA;EACA,CAjBA;EAmBAC;IACAC;EADA,CAnBA;EAuBAC;IACAC;MAEA;MAEA;;MAEA;QACA;QACA;MACA;;MACA;IACA,CAZA;;IAcAC;MAGA,iBAHA,CAKA;;MACA;MAEA;;MAEA;QACA;MACA;;MAEA;QACA;MACA;;MAEA;QACA;MACA;;MAEA;QACA;MACA;IACA,CAvCA;;IA2CAC;MACA;MACAC;QACAC;UACA;QADA;MADA,GAIAC,IAJA,CAIAC;QACAC;;QACA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA,CAXA;IAYA;;EAzDA;AAvBA","names":["name","data","total","products_id","store","order","success","error","email","tel","errors","mounted","components","PizzaBlockProfile","methods","GetOrder","ValidateForm","SendOrder","axios","headers","then","response","console"],"sourceRoot":"src/views","sources":["ProfileView.vue"],"sourcesContent":["<template>\r\n<div id=\"MainView\">\r\n<div class=\"container flex-column\">\r\n<h2 class=\"text-light\">Оформить заказ</h2>\r\n<div class=\"b0\">\r\n<PizzaBlockProfile v-bind:total.sync=\"total\" :index=\"index\" v-for=\"(dates, index) in order\"\r\n  v-bind:key=\"index\"\r\n  v-bind:dates=\"dates\"></PizzaBlockProfile>\r\n</div>\r\n\r\n\r\n<form name=\"OrderForm\">\r\n<div v-if=\"success\">Заказ успешно отправлен</div>\r\n<div v-if=\"error\">Не удалось отправить заказ!</div>\r\n\r\n<div v-if=\"errors.length\">\r\n<li v-for=\"(error,index) in errors\" v-bind:key=\"index\">{{ error }}</li>\r\n</div>\r\n\r\n\r\n<input placeholder=\"Введите имя\"  v-model=\"name\" type=\"text\" name=\"name\" class=\"form-control\">\r\n<input type=\"email\" v-model=\"email\" name=\"email\" placeholder=\"Введите email\" class=\"form-control\">\r\n<input type=\"tel\" v-model=\"tel\" name=\"tel\" placeholder=\"Введите номер телефона\" class=\"form-control\">\r\n<input id=\"products_id\" v-model=\"products_id\" type=\"hidden\" name=\"products_id\">\r\n<span>Итоговая сумма: {{total}} рублей</span>\r\n<button v-on:click=\"ValidateForm\" type=\"button\" class=\"btn btn-primary\">Добавить</button>\r\n</form> \r\n\r\n\r\n\r\n</div>\r\n\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport PizzaBlockProfile from './ProfileView/PizzaBlockProfile.vue'\r\nimport store from './../store';\r\nimport axios from 'axios'\r\n\r\nexport default {\r\nname: 'ProfileView',\r\ndata:()=>({\r\ntotal:0,\r\nproducts_id:'',\r\nstore:store,\r\norder:[],\r\nsuccess:false,\r\nerror:false,\r\nname:null,\r\nemail:null,\r\ntel:null,\r\nerrors:[]\r\n}),  \r\n\r\nmounted:function(){\r\nthis.GetOrder()\r\n},\r\n\r\ncomponents: {\r\nPizzaBlockProfile:PizzaBlockProfile\r\n},\r\n\r\nmethods:{\r\nGetOrder(){\r\n\r\nthis.order=this.store.products.pizza;\r\n\r\nlet i=0\r\n\r\nfor (i=0;i<this.store.products.pizza.length;i++){\r\nthis.total+=Number(this.store.products.pizza[i].price)\r\nthis.products_id+=this.store.products.pizza[i].id+'|'\r\n}\r\nthis.store.products_id=this.products_id\r\n},\r\n\r\nValidateForm(){\r\n\r\n\r\nthis.errors=[]\r\n\r\n// eslint-disable-next-line\r\nlet reg_tel = /^(\\+7|7|8)?[\\s\\-]?\\(?[489][0-9]{2}\\)?[\\s\\-]?[0-9]{3}[\\s\\-]?[0-9]{2}[\\s\\-]?[0-9]{2}$/\r\n\r\nlet reg_email = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\r\n\r\nif (!this.name) {\r\n        this.errors.push('Укажите имя.');\r\n}\r\n\r\nif (!reg_tel.test(this.tel)) {\r\n        this.errors.push('Некорректный номер телефона.');\r\n}\r\n\r\nif (!reg_email.test(this.email)) {\r\n        this.errors.push('Некорректный адрес электронной почт.');\r\n}\r\n\r\nif(this.errors.length==0){ \r\nthis.SendOrder()\r\n}\r\n}\r\n,\r\n\r\n\r\nSendOrder(){\r\nvar formData = new FormData(document.forms.OrderForm)\r\naxios.post('http://testpizzabackend/public/api/upload_order', formData, {\r\nheaders: {\r\n'Content-Type': 'multipart/form-data'\r\n}\r\n}).then(response => {\r\nconsole.log(\"response\", response.data.success)\r\nif (response.data.success=='ok'){\r\nthis.success=true\r\n} else {\r\nthis.error=true\r\n}\r\n})\r\n}\r\n\r\n}\r\n}\r\n</script>\r\n\r\n<style scope>\r\n#MainView .container{background: #343a40;border-radius:6px;padding:20px 0px;}\r\n#MainView .container .b0{flex-flow:column nowrap;display:inline-flex;margin:20px 0px 0px 0px;}\r\n#MainView .container form{flex-flow:column nowrap;display:inline-flex;}\r\n#MainView .container form input{margin:20px 0px 0px 0px;}\r\n#MainView .container form span{margin:20px 0px 0px 0px;color:#28a745;}\r\n#MainView .container form button{margin:20px 0px 20px 0px;}\r\n</style>"]},"metadata":{},"sourceType":"module"}